# Azure Deployment

Deploy Prediction Guard on Microsoft Azure using our managed Kubernetes deployment.

## Prerequisites

- **Azure subscription** with appropriate permissions
- **Azure CLI** installed and configured
- **kubectl** configured for your AKS cluster
- **Access to admin panel** at admin.predictionguard.com

## Deployment Process

### 1. Create AKS Cluster

First, create an Azure Kubernetes Service cluster:

```bash
# Create resource group
az group create --name predictionguard-rg --location eastus

# Create AKS cluster
az aks create --resource-group predictionguard-rg --name predictionguard-cluster --node-count 3 --node-vm-size Standard_D2s_v3 --enable-addons monitoring --generate-ssh-keys
```

### 2. Configure kubectl

```bash
# Get credentials
az aks get-credentials --resource-group predictionguard-rg --name predictionguard-cluster

# Verify connection
kubectl get nodes
```

### 3. Access Admin Panel

Navigate to [admin.predictionguard.com](https://admin.predictionguard.com) and log in with your credentials.

### 4. Create Cluster in Admin Panel

1. Click **"Create Cluster"** from the dashboard
2. Select **"Advanced"** mode for full configuration
3. Configure your cluster settings:

#### General Settings
- **Cluster Name**: Choose a unique name (e.g., `azure-production-cluster`)
- **Air-Gapped Cluster**: Leave disabled for cloud deployment
- **Image Registry**: Use Azure Container Registry or your preferred registry
- **Hugging Face API Token**: Provide your token for model access
- **Enable Ingress**: Enable for external API access

#### Azure-Specific Configuration
- **Node Pools**: Configure your AKS node pools
- **Storage Classes**: Use Azure Disk CSI driver for persistent volumes
- **Load Balancer**: Configure Azure Load Balancer for ingress
- **Virtual Network**: Specify your VNet and subnet configuration

### 5. Copy the Kubernetes installation command from your Prediction Guard Admin portal using the Deploy button on the Clusters page.

### 6. Paste and run the command on a machine that can connect to your Kubernetes cluster API via `kubectl`.This will install your authentication token and begin the initial bootstrapping of Prediction Guard services. After a few minutes, feel free to check the installation by checking the running pods in the `predictionguard` namespace:

```bash
kubectl get pods -n predictionguard
```

You should see running pods in the namespace, including `pg-inside` indicating that the cluster has been successfully installed. The cluster should also show as **Healthy** in the Prediction Guard admin.

### 7. Deploy any desired AI models from the Models page in the Prediction Guard admin. Pay attention to any settings around number of AI accelerators, CPU and memory allocation to the model and ensure it fits within your Kubernetes cluster resources.

## Configuring Ingress and Reverse Proxy

Prediction Guard comes preconfigured for NGINX and a default Ingress which can be enabled on the cluster within the **Edit** section of the Clusters page. Here you can configure the desired domain names and have NGINX deploy into the `predictionguard` namespace with preconfigured settings for the Prediction Guard API. Then, simply ensure that your DNS entry is routable to the ingress IP on your Kubernetes cluster or load balancer in Azure.

## Post-Deployment

### Access Your Cluster

Once deployed, your cluster will be accessible through:

- **Admin Panel**: Monitor and manage from admin.predictionguard.com
- **API Endpoints**: Access your deployed models via the configured endpoints
- **Kubernetes Dashboard**: Use kubectl to manage cluster resources

### Azure Integration

Your deployment will automatically integrate with:

- **Azure Disk**: Persistent storage for models and data
- **Azure Load Balancer**: Load balancing for high availability
- **Azure Monitor**: Monitoring and logging
- **Azure Active Directory**: Service account and role management

---

**Need help?** Contact our support team for assistance with your Azure deployment.
